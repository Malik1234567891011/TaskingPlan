<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Project Tasking Plan</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                    Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
                background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
                padding: 20px;
                min-height: 100vh;
            }

            .container {
                max-width: 1400px;
                margin: 0 auto;
                background: white;
                border-radius: 16px;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                overflow: hidden;
            }

            .header {
                background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
                color: white;
                padding: 30px 40px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                flex-wrap: wrap;
                gap: 20px;
            }

            .header-left h1 {
                font-size: 28px;
                margin-bottom: 8px;
            }

            .header-left p {
                opacity: 0.9;
                font-size: 14px;
            }

            .header-actions {
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
            }

            .btn {
                padding: 10px 20px;
                border: none;
                border-radius: 8px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.2s;
                white-space: nowrap;
            }

            .btn-primary {
                background: white;
                color: #000000;
            }

            .btn-primary:hover {
                background: #e0e0e0;
            }

            .btn-secondary {
                background: rgba(255, 255, 255, 0.2);
                color: white;
                border: 1px solid rgba(255, 255, 255, 0.4);
            }

            .btn-secondary:hover {
                background: rgba(255, 255, 255, 0.3);
            }

            .stats {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
                gap: 20px;
                padding: 30px 40px;
                background: #f8f9fa;
                border-bottom: 1px solid #e0e0e0;
            }

            .stat-card {
                background: white;
                padding: 20px;
                border-radius: 12px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            }

            .stat-card h3 {
                font-size: 32px;
                margin-bottom: 5px;
                background: linear-gradient(135deg, #000000 0%, #4a4a4a 100%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }

            .stat-card p {
                color: #666;
                font-size: 13px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .table-container {
                overflow-x: auto;
                padding: 0 40px 40px 40px;
            }

            table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 20px;
            }

            thead {
                background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
                color: white;
            }

            th {
                padding: 16px 12px;
                text-align: left;
                font-weight: 600;
                font-size: 13px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                white-space: nowrap;
            }

            tbody tr {
                border-bottom: 1px solid #e0e0e0;
                transition: background-color 0.2s;
            }

            tbody tr:hover {
                background-color: #f8f9fa;
            }

            tbody tr.overdue-row {
                background-color: #fff5f5;
            }

            td {
                padding: 16px 12px;
                font-size: 14px;
            }

            .task-id {
                font-weight: 700;
                color: #1a1a1a;
                min-width: 40px;
            }

            .task-desc {
                max-width: 400px;
                line-height: 1.5;
                cursor: text;
                padding: 4px;
                border-radius: 4px;
            }

            .task-desc:hover {
                background: #f0f0f0;
            }

            .assignee {
                display: inline-block;
                padding: 6px 14px;
                border-radius: 20px;
                font-size: 12px;
                font-weight: 600;
                cursor: pointer;
                transition: opacity 0.2s;
            }

            .assignee:hover {
                opacity: 0.8;
            }

            .assignee.muhammad {
                background: #e0e0e0;
                color: #1a1a1a;
            }

            .assignee.malik {
                background: #c0c0c0;
                color: #000000;
            }

            .assignee.both {
                background: #a0a0a0;
                color: #000000;
            }

            .status {
                display: inline-block;
                padding: 6px 14px;
                border-radius: 20px;
                font-size: 12px;
                font-weight: 600;
                text-transform: uppercase;
                cursor: pointer;
                transition: opacity 0.2s;
            }

            .status:hover {
                opacity: 0.8;
            }

            .status.completed {
                background: #c8e6c9;
                color: #2e7d32;
            }

            .status.in-progress {
                background: #fff9c4;
                color: #f57f17;
            }

            .status.pending {
                background: #e0e0e0;
                color: #616161;
            }

            .status.overdue {
                background: #ffcdd2;
                color: #c62828;
            }

            .loe {
                text-align: center;
                font-weight: 600;
                color: #1a1a1a;
                cursor: text;
            }

            .deadline {
                white-space: nowrap;
                font-weight: 500;
                cursor: text;
                padding: 4px 8px;
                border-radius: 4px;
            }

            .deadline:hover {
                background: #f0f0f0;
            }

            .deadline.overdue-date {
                color: #c62828;
                font-weight: 700;
            }

            .dependencies {
                color: #666;
                font-size: 13px;
            }

            .legend {
                padding: 20px 40px;
                background: #f8f9fa;
                border-top: 1px solid #e0e0e0;
                display: flex;
                gap: 30px;
                flex-wrap: wrap;
                align-items: center;
            }

            .legend-item {
                display: flex;
                align-items: center;
                gap: 8px;
                font-size: 13px;
            }

            .legend-dot {
                width: 12px;
                height: 12px;
                border-radius: 50%;
            }

            .editable-input {
                width: 100%;
                padding: 8px;
                border: 2px solid #1a1a1a;
                border-radius: 4px;
                font-family: inherit;
                font-size: 14px;
            }

            .editable-textarea {
                width: 100%;
                padding: 8px;
                border: 2px solid #1a1a1a;
                border-radius: 4px;
                font-family: inherit;
                font-size: 14px;
                min-height: 60px;
                resize: vertical;
            }

            .modal {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 1000;
                align-items: center;
                justify-content: center;
            }

            .modal.active {
                display: flex;
            }

            .modal-content {
                background: white;
                padding: 30px;
                border-radius: 16px;
                max-width: 500px;
                width: 90%;
                max-height: 80vh;
                overflow-y: auto;
            }

            .modal-content h2 {
                margin-bottom: 20px;
                color: #1a1a1a;
            }

            .modal-content textarea {
                width: 100%;
                min-height: 300px;
                padding: 12px;
                border: 1px solid #ddd;
                border-radius: 8px;
                font-family: monospace;
                font-size: 12px;
            }

            .modal-actions {
                display: flex;
                gap: 10px;
                margin-top: 20px;
                justify-content: flex-end;
            }

            .hours-estimate {
                font-size: 11px;
                color: #999;
                font-style: italic;
                margin-top: 2px;
            }

            .task-actions {
                display: flex;
                gap: 8px;
                align-items: center;
            }

            .action-btn {
                padding: 4px 10px;
                border: none;
                border-radius: 6px;
                font-size: 12px;
                cursor: pointer;
                transition: all 0.2s;
                font-weight: 500;
            }

            .edit-btn {
                background: #e0e0e0;
                color: #000000;
            }

            .edit-btn:hover {
                background: #c0c0c0;
            }

            .delete-btn {
                background: #ffebee;
                color: #c62828;
            }

            .delete-btn:hover {
                background: #ffcdd2;
            }

            .drag-handle {
                cursor: move;
                color: #999;
                font-size: 16px;
                padding: 0 8px;
            }

            .drag-handle:hover {
                color: #000000;
            }

            tbody tr.dragging {
                opacity: 0.5;
            }

            tbody tr.drag-over {
                border-top: 3px solid #000000;
            }

            @media (max-width: 768px) {
                .stats {
                    grid-template-columns: 1fr 1fr;
                }

                .table-container {
                    padding: 0 20px 20px 20px;
                }

                .header {
                    padding: 20px;
                }

                .header-actions {
                    width: 100%;
                }

                .btn {
                    flex: 1;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <div class="header-left">
                    <h1>📋 Project Tasking Plan</h1>
                    <p id="current-date">Status as of October 21, 2025</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="exportData()">
                        💾 Export JSON
                    </button>
                    <button class="btn btn-secondary" onclick="importData()">
                        📥 Import JSON
                    </button>
                    <button class="btn btn-secondary" onclick="addNewTask()">
                        ➕ Add Task
                    </button>
                    <button
                        class="btn btn-secondary"
                        onclick="resetToDefault()"
                        title="Reset to default with reduced hours"
                    >
                        🔄 Reset Hours
                    </button>
                </div>
            </div>

            <div class="stats" id="stats">
                <div class="stat-card">
                    <h3 id="total-tasks">24</h3>
                    <p>Total Tasks</p>
                </div>
                <div class="stat-card">
                    <h3 id="completed-tasks">7</h3>
                    <p>Completed</p>
                </div>
                <div class="stat-card">
                    <h3 id="in-progress-tasks">3</h3>
                    <p>In Progress</p>
                </div>
                <div class="stat-card">
                    <h3 id="overdue-tasks">2</h3>
                    <p>Overdue</p>
                </div>
                <div class="stat-card">
                    <h3 id="hours-remaining">0</h3>
                    <p>Hours Remaining</p>
                </div>
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th style="width: 40px">⠿</th>
                            <th>#</th>
                            <th>Task Description</th>
                            <th>Dependencies</th>
                            <th>Assigned To</th>
                            <th>LOE</th>
                            <th>Deadline</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="task-table">
                        <tr>
                            <td class="task-id">1</td>
                            <td class="task-desc">
                                Verify project setup & tooling: Confirm repo
                                structure, Gradle sync, Compose preview works,
                                Room/OCR libs resolve; create CONTRIBUTING.md
                                with branch naming and PR checklist.
                            </td>
                            <td class="dependencies">—</td>
                            <td><span class="assignee both">Both</span></td>
                            <td class="loe">1</td>
                            <td class="deadline">Oct 24</td>
                            <td>
                                <span class="status completed">Completed</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="task-id">2</td>
                            <td class="task-desc">
                                UserProfile + Room schema v1: Implement
                                UserProfile, Restaurant, MenuCapture, MenuItem
                                entities, DAOs, and type converters
                                (lists/tags).
                            </td>
                            <td class="dependencies">1</td>
                            <td>
                                <span class="assignee muhammad">Muhammad</span>
                            </td>
                            <td class="loe">2</td>
                            <td class="deadline">Oct 27</td>
                            <td>
                                <span class="status completed">Completed</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="task-id">3</td>
                            <td class="task-desc">
                                Onboarding UI (language + tags): Chips for
                                allergies, dislikes, preferences; validation
                                (language required), save to Room.
                            </td>
                            <td class="dependencies">1</td>
                            <td><span class="assignee malik">Malik</span></td>
                            <td class="loe">2</td>
                            <td class="deadline">Oct 28</td>
                            <td>
                                <span class="status completed">Completed</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="task-id">4</td>
                            <td class="task-desc">
                                Bottom navigation & nav graph: Tabs for Scan,
                                Menu, Profile; back-stack behavior and
                                deep-links for opening a saved menu.
                            </td>
                            <td class="dependencies">1</td>
                            <td>
                                <span class="assignee muhammad">Muhammad</span>
                            </td>
                            <td class="loe">2</td>
                            <td class="deadline">Oct 29</td>
                            <td>
                                <span class="status completed">Completed</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="task-id">5</td>
                            <td class="task-desc">
                                OCR integration (image picker): Import image,
                                run OCR, return raw text blocks; basic error
                                codes for quality/format/connectivity.
                            </td>
                            <td class="dependencies">1</td>
                            <td>
                                <span class="assignee muhammad">Muhammad</span>
                            </td>
                            <td class="loe">3</td>
                            <td class="deadline">Nov 3</td>
                            <td><span class="status overdue">Overdue</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">6</td>
                            <td class="task-desc">
                                Translation integration: Translate
                                titles/descriptions when language differs; store
                                both original and translated copies; toggle in
                                UI state.
                            </td>
                            <td class="dependencies">5</td>
                            <td><span class="assignee malik">Malik</span></td>
                            <td class="loe">2</td>
                            <td class="deadline">Nov 5</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">7</td>
                            <td class="task-desc">
                                Early OCR+Translation test pass: Use 8–10
                                diverse menu fixtures (photo, scan, foreign
                                language); log failures with example images.
                            </td>
                            <td class="dependencies">5–6</td>
                            <td><span class="assignee both">Both</span></td>
                            <td class="loe">1</td>
                            <td class="deadline">Nov 5</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">8</td>
                            <td class="task-desc">
                                Parsing + normalization: Title/description/price
                                segmentation; tokenization; synonym map
                                ("garbanzo → chickpea", "prawn → shrimp");
                                family mapping (tree nut, shellfish).
                            </td>
                            <td class="dependencies">5–6</td>
                            <td>
                                <span class="assignee muhammad">Muhammad</span>
                            </td>
                            <td class="loe">3</td>
                            <td class="deadline">Nov 8</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">9</td>
                            <td class="task-desc">
                                Risk classification (pure function): Implement
                                deterministic Red/Yellow/Green with precedence;
                                returns reasons list; unit tests (table-driven).
                            </td>
                            <td class="dependencies">8</td>
                            <td><span class="assignee malik">Malik</span></td>
                            <td class="loe">2</td>
                            <td class="deadline">Nov 10</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">10</td>
                            <td class="task-desc">
                                Detailed Menu screen: Cards with
                                title/price/description; translated/original
                                toggle; risk badge; "why?" sheet using evidence
                                list.
                            </td>
                            <td class="dependencies">8–9</td>
                            <td>
                                <span class="assignee muhammad">Muhammad</span>
                            </td>
                            <td class="loe">3</td>
                            <td class="deadline">Nov 12</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">11</td>
                            <td class="task-desc">
                                Live profile sync: When profile changes,
                                re-evaluate open/saved menus on load; show
                                lightweight "recomputed" toast.
                            </td>
                            <td class="dependencies">2, 9</td>
                            <td><span class="assignee malik">Malik</span></td>
                            <td class="loe">2</td>
                            <td class="deadline">Nov 13</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">12</td>
                            <td class="task-desc">
                                Saved Menu screen: Grid list with restaurant
                                name, date, and quick counts (e.g., red count);
                                click opens Detailed Menu.
                            </td>
                            <td class="dependencies">2</td>
                            <td>
                                <span class="assignee muhammad">Muhammad</span>
                            </td>
                            <td class="loe">2</td>
                            <td class="deadline">Nov 17</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">13</td>
                            <td class="task-desc">
                                Profile screen: Edit language and tags with same
                                chip UX; prevent duplicates; persist to Room.
                            </td>
                            <td class="dependencies">2</td>
                            <td><span class="assignee malik">Malik</span></td>
                            <td class="loe">2</td>
                            <td class="deadline">Nov 18</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">14</td>
                            <td class="task-desc">
                                Error taxonomy & UX: Map OCR/translation/parsing
                                outcomes to friendly messages; progress
                                indicators; retry flows.
                            </td>
                            <td class="dependencies">5–10</td>
                            <td>
                                <span class="assignee muhammad">Muhammad</span>
                            </td>
                            <td class="loe">2</td>
                            <td class="deadline">Nov 20</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">15</td>
                            <td class="task-desc">
                                Accessibility pass: Content descriptions, focus
                                order, touch target sizes, color+icon+text for
                                risk, contrast check.
                            </td>
                            <td class="dependencies">10–13</td>
                            <td><span class="assignee malik">Malik</span></td>
                            <td class="loe">1</td>
                            <td class="deadline">Nov 22</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">16</td>
                            <td class="task-desc">
                                Internal QA round: Re-eval saved menus; offline
                                behavior (airplane mode); open-time under 15s
                                for 1-page menu on mid-range device.
                            </td>
                            <td class="dependencies">All</td>
                            <td><span class="assignee both">Both</span></td>
                            <td class="loe">3</td>
                            <td class="deadline">Nov 24</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">17</td>
                            <td class="task-desc">
                                Performance & polish: Simple image
                                pre-processing (rotate/auto-contrast), Room
                                query tuning, jank fixes on long lists.
                            </td>
                            <td class="dependencies">16</td>
                            <td>
                                <span class="assignee muhammad">Muhammad</span>
                            </td>
                            <td class="loe">2</td>
                            <td class="deadline">Nov 26</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">18</td>
                            <td class="task-desc">
                                Test fixtures & demo data: Curate final menu set
                                (EN/FR/ES, fancy vs casual); script to
                                load/delete fixtures quickly.
                            </td>
                            <td class="dependencies">16</td>
                            <td><span class="assignee malik">Malik</span></td>
                            <td class="loe">1</td>
                            <td class="deadline">Nov 27</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">19</td>
                            <td class="task-desc">
                                Static analysis & CI basics: Add ktlint, Gradle
                                tasks; GitHub Action for build + lint on PRs;
                                status badges.
                            </td>
                            <td class="dependencies">1</td>
                            <td>
                                <span class="assignee muhammad">Muhammad</span>
                            </td>
                            <td class="loe">1</td>
                            <td class="deadline">Nov 27</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">20</td>
                            <td class="task-desc">
                                Offline-first sanity: Ensure all critical
                                screens work with no network; graceful
                                model-download checks if needed.
                            </td>
                            <td class="dependencies">16</td>
                            <td><span class="assignee malik">Malik</span></td>
                            <td class="loe">1</td>
                            <td class="deadline">Nov 28</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">21</td>
                            <td class="task-desc">
                                Final QA: Regression list from earlier bugs; run
                                through rubric; confirm deterministic
                                classification on repeated inputs.
                            </td>
                            <td class="dependencies">16–20</td>
                            <td><span class="assignee both">Both</span></td>
                            <td class="loe">2</td>
                            <td class="deadline">Dec 1</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">22</td>
                            <td class="task-desc">
                                Docs & slides: Update README, Part A–D
                                excerpts/screens; record short screen captures
                                for PRs and demo.
                            </td>
                            <td class="dependencies">21</td>
                            <td><span class="assignee both">Both</span></td>
                            <td class="loe">2</td>
                            <td class="deadline">Dec 2</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">23</td>
                            <td class="task-desc">
                                Release build & dry-run: Generate signed release
                                APK, install on two physical devices; time the
                                full demo flow.
                            </td>
                            <td class="dependencies">22</td>
                            <td><span class="assignee both">Both</span></td>
                            <td class="loe">1</td>
                            <td class="deadline">Dec 4</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                        <tr>
                            <td class="task-id">24</td>
                            <td class="task-desc">
                                Presentation & final polish: Demo checklist,
                                backup device, extra APK on USB; finalize
                                speaking parts.
                            </td>
                            <td class="dependencies">23</td>
                            <td><span class="assignee both">Both</span></td>
                            <td class="loe">1</td>
                            <td class="deadline">Dec 5</td>
                            <td><span class="status pending">Pending</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="legend">
                <strong>Status Legend:</strong>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #c8e6c9"></div>
                    <span>Completed</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #fff9c4"></div>
                    <span>In Progress</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #e0e0e0"></div>
                    <span>Pending</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #ffcdd2"></div>
                    <span>Overdue</span>
                </div>
            </div>
        </div>

        <!-- Import/Export Modal -->
        <div id="import-modal" class="modal">
            <div class="modal-content">
                <h2>Import Tasks from JSON</h2>
                <textarea
                    id="import-textarea"
                    placeholder="Paste your JSON data here..."
                ></textarea>
                <div class="modal-actions">
                    <button
                        class="btn btn-secondary"
                        onclick="closeImportModal()"
                    >
                        Cancel
                    </button>
                    <button class="btn btn-primary" onclick="confirmImport()">
                        Import
                    </button>
                </div>
            </div>
        </div>

        <script>
            // Initial task data
            let tasks = [
                {
                    id: 1,
                    desc: "Verify project setup & tooling: Confirm repo structure, Gradle sync, Compose preview works, Room/OCR libs resolve; create CONTRIBUTING.md with branch naming and PR checklist.",
                    deps: "—",
                    assignee: "both",
                    days: 1,
                    hours: 2,
                    deadline: "2025-10-24",
                    status: "completed",
                },
                {
                    id: 2,
                    desc: "UserProfile + Room schema v1: Implement UserProfile, Restaurant, MenuCapture, MenuItem entities, DAOs, and type converters (lists/tags).",
                    deps: "1",
                    assignee: "muhammad",
                    days: 2,
                    hours: 4,
                    deadline: "2025-10-27",
                    status: "completed",
                },
                {
                    id: 3,
                    desc: "Onboarding UI (language + tags): Chips for allergies, dislikes, preferences; validation (language required), save to Room.",
                    deps: "1",
                    assignee: "malik",
                    days: 2,
                    hours: 4,
                    deadline: "2025-10-28",
                    status: "completed",
                },
                {
                    id: 4,
                    desc: "Bottom navigation & nav graph: Tabs for Scan, Menu, Profile; back-stack behavior and deep-links for opening a saved menu.",
                    deps: "1",
                    assignee: "muhammad",
                    days: 2,
                    hours: 3,
                    deadline: "2025-10-29",
                    status: "completed",
                },
                {
                    id: 5,
                    desc: "OCR integration (image picker): Import image, run OCR, return raw text blocks; basic error codes for quality/format/connectivity.",
                    deps: "1",
                    assignee: "muhammad",
                    days: 3,
                    hours: 3,
                    deadline: "2025-11-03",
                    status: "in-progress",
                },
                {
                    id: 6,
                    desc: "Translation integration: Translate titles/descriptions when language differs; store both original and translated copies; toggle in UI state.",
                    deps: "5",
                    assignee: "malik",
                    days: 2,
                    hours: 2,
                    deadline: "2025-11-05",
                    status: "pending",
                },
                {
                    id: 7,
                    desc: "Early OCR+Translation test pass: Use 8–10 diverse menu fixtures (photo, scan, foreign language); log failures with example images.",
                    deps: "5–6",
                    assignee: "both",
                    days: 1,
                    hours: 1,
                    deadline: "2025-11-05",
                    status: "pending",
                },
                {
                    id: 8,
                    desc: 'Parsing + normalization: Title/description/price segmentation; tokenization; synonym map ("garbanzo → chickpea", "prawn → shrimp"); family mapping (tree nut, shellfish).',
                    deps: "5–6",
                    assignee: "muhammad",
                    days: 3,
                    hours: 3,
                    deadline: "2025-11-08",
                    status: "pending",
                },
                {
                    id: 9,
                    desc: "Risk classification (pure function): Implement deterministic Red/Yellow/Green with precedence; returns reasons list; unit tests (table-driven).",
                    deps: "8",
                    assignee: "malik",
                    days: 2,
                    hours: 2,
                    deadline: "2025-11-10",
                    status: "pending",
                },
                {
                    id: 10,
                    desc: 'Detailed Menu screen: Cards with title/price/description; translated/original toggle; risk badge; "why?" sheet using evidence list.',
                    deps: "8–9",
                    assignee: "muhammad",
                    days: 3,
                    hours: 3,
                    deadline: "2025-11-12",
                    status: "pending",
                },
                {
                    id: 11,
                    desc: 'Live profile sync: When profile changes, re-evaluate open/saved menus on load; show lightweight "recomputed" toast.',
                    deps: "2, 9",
                    assignee: "malik",
                    days: 2,
                    hours: 2,
                    deadline: "2025-11-13",
                    status: "pending",
                },
                {
                    id: 12,
                    desc: "Saved Menu screen: Grid list with restaurant name, date, and quick counts (e.g., red count); click opens Detailed Menu.",
                    deps: "2",
                    assignee: "muhammad",
                    days: 2,
                    hours: 2,
                    deadline: "2025-11-17",
                    status: "pending",
                },
                {
                    id: 13,
                    desc: "Profile screen: Edit language and tags with same chip UX; prevent duplicates; persist to Room.",
                    deps: "2",
                    assignee: "malik",
                    days: 2,
                    hours: 2,
                    deadline: "2025-11-18",
                    status: "pending",
                },
                {
                    id: 14,
                    desc: "Error taxonomy & UX: Map OCR/translation/parsing outcomes to friendly messages; progress indicators; retry flows.",
                    deps: "5–10",
                    assignee: "muhammad",
                    days: 2,
                    hours: 2,
                    deadline: "2025-11-20",
                    status: "pending",
                },
                {
                    id: 15,
                    desc: "Accessibility pass: Content descriptions, focus order, touch target sizes, color+icon+text for risk, contrast check.",
                    deps: "10–13",
                    assignee: "malik",
                    days: 1,
                    hours: 1,
                    deadline: "2025-11-22",
                    status: "pending",
                },
                {
                    id: 16,
                    desc: "Internal QA round: Re-eval saved menus; offline behavior (airplane mode); open-time under 15s for 1-page menu on mid-range device.",
                    deps: "All",
                    assignee: "both",
                    days: 3,
                    hours: 3,
                    deadline: "2025-11-24",
                    status: "pending",
                },
                {
                    id: 17,
                    desc: "Performance & polish: Simple image pre-processing (rotate/auto-contrast), Room query tuning, jank fixes on long lists.",
                    deps: "16",
                    assignee: "muhammad",
                    days: 2,
                    hours: 2,
                    deadline: "2025-11-26",
                    status: "pending",
                },
                {
                    id: 18,
                    desc: "Test fixtures & demo data: Curate final menu set (EN/FR/ES, fancy vs casual); script to load/delete fixtures quickly.",
                    deps: "16",
                    assignee: "malik",
                    days: 1,
                    hours: 1,
                    deadline: "2025-11-27",
                    status: "pending",
                },
                {
                    id: 19,
                    desc: "Static analysis & CI basics: Add ktlint, Gradle tasks; GitHub Action for build + lint on PRs; status badges.",
                    deps: "1",
                    assignee: "muhammad",
                    days: 1,
                    hours: 1,
                    deadline: "2025-11-27",
                    status: "pending",
                },
                {
                    id: 20,
                    desc: "Offline-first sanity: Ensure all critical screens work with no network; graceful model-download checks if needed.",
                    deps: "16",
                    assignee: "malik",
                    days: 1,
                    hours: 1,
                    deadline: "2025-11-28",
                    status: "pending",
                },
                {
                    id: 21,
                    desc: "Final QA: Regression list from earlier bugs; run through rubric; confirm deterministic classification on repeated inputs.",
                    deps: "16–20",
                    assignee: "both",
                    days: 2,
                    hours: 2,
                    deadline: "2025-12-01",
                    status: "pending",
                },
                {
                    id: 22,
                    desc: "Docs & slides: Update README, Part A–D excerpts/screens; record short screen captures for PRs and demo.",
                    deps: "21",
                    assignee: "both",
                    days: 2,
                    hours: 2,
                    deadline: "2025-12-02",
                    status: "pending",
                },
                {
                    id: 23,
                    desc: "Release build & dry-run: Generate signed release APK, install on two physical devices; time the full demo flow.",
                    deps: "22",
                    assignee: "both",
                    days: 1,
                    hours: 1,
                    deadline: "2025-12-04",
                    status: "pending",
                },
                {
                    id: 24,
                    desc: "Presentation & final polish: Demo checklist, backup device, extra APK on USB; finalize speaking parts.",
                    deps: "23",
                    assignee: "both",
                    days: 1,
                    hours: 1,
                    deadline: "2025-12-05",
                    status: "pending",
                },
            ];

            // Load from localStorage if exists
            function loadFromStorage() {
                const saved = localStorage.getItem("taskingPlan");
                if (saved) {
                    try {
                        tasks = JSON.parse(saved);
                    } catch (e) {
                        console.error("Error loading from storage:", e);
                    }
                }
            }

            // Save to localStorage
            function saveToStorage() {
                localStorage.setItem("taskingPlan", JSON.stringify(tasks));
            }

            // Format date for display
            function formatDate(dateStr) {
                const date = new Date(dateStr);
                const month = date.toLocaleString("default", {
                    month: "short",
                });
                const day = date.getDate();
                return `${month} ${day}`;
            }

            // Check if task is overdue
            function isOverdue(deadline, status) {
                if (status === "completed") return false;
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const deadlineDate = new Date(deadline);
                deadlineDate.setHours(0, 0, 0, 0);
                return deadlineDate < today;
            }

            // Update statistics
            function updateStats() {
                const total = tasks.length;
                const completed = tasks.filter(
                    (t) => t.status === "completed"
                ).length;
                const inProgress = tasks.filter(
                    (t) => t.status === "in-progress"
                ).length;
                const overdue = tasks.filter((t) =>
                    isOverdue(t.deadline, t.status)
                ).length;
                const hoursRemaining = tasks
                    .filter((t) => t.status !== "completed")
                    .reduce((sum, t) => sum + (t.hours || 0), 0);

                document.getElementById("total-tasks").textContent = total;
                document.getElementById("completed-tasks").textContent =
                    completed;
                document.getElementById("in-progress-tasks").textContent =
                    inProgress;
                document.getElementById("overdue-tasks").textContent = overdue;
                document.getElementById("hours-remaining").textContent =
                    hoursRemaining;

                // Update current date
                const today = new Date();
                const options = {
                    year: "numeric",
                    month: "long",
                    day: "numeric",
                };
                document.getElementById("current-date").textContent =
                    "Status as of " +
                    today.toLocaleDateString("en-US", options);
            }

            // Render table
            function renderTable() {
                const tbody = document.getElementById("task-table");
                tbody.innerHTML = "";

                tasks.forEach((task, index) => {
                    const overdue = isOverdue(task.deadline, task.status);
                    const displayStatus =
                        overdue && task.status !== "completed"
                            ? "overdue"
                            : task.status;

                    const tr = document.createElement("tr");
                    if (overdue && task.status !== "completed") {
                        tr.classList.add("overdue-row");
                    }

                    // Make row draggable
                    tr.draggable = true;
                    tr.dataset.taskId = task.id;
                    tr.dataset.index = index;

                    // Add drag event listeners
                    tr.addEventListener("dragstart", handleDragStart);
                    tr.addEventListener("dragover", handleDragOver);
                    tr.addEventListener("drop", handleDrop);
                    tr.addEventListener("dragend", handleDragEnd);
                    tr.addEventListener("dragleave", handleDragLeave);

                    // Display position number (index + 1) instead of task.id
                    const displayNumber = index + 1;

                    tr.innerHTML = `
                        <td class="drag-handle">⠿</td>
                        <td class="task-id">${displayNumber}</td>
                        <td class="task-desc" ondblclick="editDesc(${
                            task.id
                        })">${task.desc}</td>
                        <td class="dependencies">${task.deps}</td>
                        <td><span class="assignee ${
                            task.assignee
                        }" onclick="cycleAssignee(${
                        task.id
                    })">${capitalizeFirst(task.assignee)}</span></td>
                        <td class="loe" ondblclick="editLOE(${task.id})">
                            ${task.days}d
                            <div class="hours-estimate">${task.hours}h</div>
                        </td>
                        <td class="deadline ${
                            overdue && task.status !== "completed"
                                ? "overdue-date"
                                : ""
                        }" ondblclick="editDeadline(${task.id})">${formatDate(
                        task.deadline
                    )}</td>
                        <td><span class="status ${displayStatus}" onclick="cycleStatus(${
                        task.id
                    })">${capitalizeFirst(displayStatus)}</span></td>
                        <td class="task-actions">
                            <button class="action-btn edit-btn" onclick="editTask(${
                                task.id
                            })">✏️ Edit</button>
                            <button class="action-btn delete-btn" onclick="deleteTask(${
                                task.id
                            })">🗑️ Delete</button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });

                updateStats();
            }

            // Drag and drop handlers
            let draggedElement = null;

            function handleDragStart(e) {
                draggedElement = this;
                this.classList.add("dragging");
                e.dataTransfer.effectAllowed = "move";
                e.dataTransfer.setData("text/html", this.innerHTML);
            }

            function handleDragOver(e) {
                if (e.preventDefault) {
                    e.preventDefault();
                }
                e.dataTransfer.dropEffect = "move";

                if (this !== draggedElement) {
                    this.classList.add("drag-over");
                }
                return false;
            }

            function handleDragLeave(e) {
                this.classList.remove("drag-over");
            }

            function handleDrop(e) {
                if (e.stopPropagation) {
                    e.stopPropagation();
                }

                if (draggedElement !== this) {
                    const draggedIndex = parseInt(draggedElement.dataset.index);
                    const targetIndex = parseInt(this.dataset.index);

                    // Reorder tasks array
                    const draggedTask = tasks[draggedIndex];
                    tasks.splice(draggedIndex, 1);
                    tasks.splice(targetIndex, 0, draggedTask);

                    saveToStorage();
                    renderTable();
                }

                return false;
            }

            function handleDragEnd(e) {
                this.classList.remove("dragging");

                // Remove all drag-over classes
                document.querySelectorAll(".drag-over").forEach((el) => {
                    el.classList.remove("drag-over");
                });
            }

            // Capitalize first letter
            function capitalizeFirst(str) {
                return str
                    .split("-")
                    .map((word) => word.charAt(0).toUpperCase() + word.slice(1))
                    .join(" ");
            }

            // Cycle status
            function cycleStatus(taskId) {
                const task = tasks.find((t) => t.id === taskId);
                if (!task) return;

                const statuses = ["pending", "in-progress", "completed"];
                const currentIndex = statuses.indexOf(task.status);
                task.status = statuses[(currentIndex + 1) % statuses.length];

                saveToStorage();
                renderTable();
            }

            // Cycle assignee
            function cycleAssignee(taskId) {
                const task = tasks.find((t) => t.id === taskId);
                if (!task) return;

                const assignees = ["malik", "muhammad", "both"];
                const currentIndex = assignees.indexOf(task.assignee);
                task.assignee =
                    assignees[(currentIndex + 1) % assignees.length];

                saveToStorage();
                renderTable();
            }

            // Edit description
            function editDesc(taskId) {
                const task = tasks.find((t) => t.id === taskId);
                if (!task) return;

                const newDesc = prompt("Edit task description:", task.desc);
                if (newDesc !== null && newDesc.trim() !== "") {
                    task.desc = newDesc.trim();
                    saveToStorage();
                    renderTable();
                }
            }

            // Edit LOE
            function editLOE(taskId) {
                const task = tasks.find((t) => t.id === taskId);
                if (!task) return;

                const newDays = prompt("Enter days:", task.days);
                const newHours = prompt("Enter hours:", task.hours);

                if (newDays !== null && !isNaN(newDays)) {
                    task.days = parseInt(newDays);
                }
                if (newHours !== null && !isNaN(newHours)) {
                    task.hours = parseInt(newHours);
                }

                saveToStorage();
                renderTable();
            }

            // Edit deadline
            function editDeadline(taskId) {
                const task = tasks.find((t) => t.id === taskId);
                if (!task) return;

                const newDeadline = prompt(
                    "Enter deadline (YYYY-MM-DD):",
                    task.deadline
                );
                if (
                    newDeadline !== null &&
                    newDeadline.match(/^\d{4}-\d{2}-\d{2}$/)
                ) {
                    task.deadline = newDeadline;
                    saveToStorage();
                    renderTable();
                }
            }

            // Edit entire task
            function editTask(taskId) {
                const task = tasks.find((t) => t.id === taskId);
                if (!task) return;

                const newDesc = prompt("Task description:", task.desc);
                if (newDesc !== null && newDesc.trim() !== "") {
                    task.desc = newDesc.trim();
                }

                const newDeps = prompt("Dependencies:", task.deps);
                if (newDeps !== null) {
                    task.deps = newDeps.trim() || "—";
                }

                const newDays = prompt("Days:", task.days);
                if (newDays !== null && !isNaN(newDays)) {
                    task.days = parseInt(newDays);
                }

                const newHours = prompt("Hours:", task.hours);
                if (newHours !== null && !isNaN(newHours)) {
                    task.hours = parseInt(newHours);
                }

                const newDeadline = prompt(
                    "Deadline (YYYY-MM-DD):",
                    task.deadline
                );
                if (
                    newDeadline !== null &&
                    newDeadline.match(/^\d{4}-\d{2}-\d{2}$/)
                ) {
                    task.deadline = newDeadline;
                }

                saveToStorage();
                renderTable();
            }

            // Delete task
            function deleteTask(taskId) {
                const task = tasks.find((t) => t.id === taskId);
                if (!task) return;

                if (
                    confirm(
                        `Are you sure you want to delete task #${task.id}?\n\n"${task.desc}"`
                    )
                ) {
                    tasks = tasks.filter((t) => t.id !== taskId);
                    saveToStorage();
                    renderTable();
                }
            }

            // Export data
            function exportData() {
                const dataStr = JSON.stringify(tasks, null, 2);
                const dataBlob = new Blob([dataStr], {
                    type: "application/json",
                });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement("a");
                link.href = url;
                link.download =
                    "tasking-plan-" +
                    new Date().toISOString().split("T")[0] +
                    ".json";
                link.click();
                URL.revokeObjectURL(url);
            }

            // Import data
            function importData() {
                document.getElementById("import-modal").classList.add("active");
            }

            function closeImportModal() {
                document
                    .getElementById("import-modal")
                    .classList.remove("active");
                document.getElementById("import-textarea").value = "";
            }

            function confirmImport() {
                const data = document.getElementById("import-textarea").value;
                try {
                    const imported = JSON.parse(data);
                    if (Array.isArray(imported) && imported.length > 0) {
                        tasks = imported;
                        saveToStorage();
                        renderTable();
                        closeImportModal();
                        alert("Tasks imported successfully!");
                    } else {
                        alert("Invalid data format");
                    }
                } catch (e) {
                    alert("Error parsing JSON: " + e.message);
                }
            }

            // Add new task
            function addNewTask() {
                const newId = Math.max(...tasks.map((t) => t.id)) + 1;
                const desc = prompt("Enter task description:");
                if (desc === null || desc.trim() === "") return;

                const newTask = {
                    id: newId,
                    desc: desc.trim(),
                    deps: "—",
                    assignee: "both",
                    days: 1,
                    hours: 8,
                    deadline: new Date().toISOString().split("T")[0],
                    status: "pending",
                };

                tasks.push(newTask);
                saveToStorage();
                renderTable();
            }

            // Reset to default data
            function resetToDefault() {
                if (
                    confirm(
                        "This will reset all tasks to default with reduced hours. Your changes will be lost. Continue?"
                    )
                ) {
                    localStorage.removeItem("taskingPlan");
                    location.reload();
                }
            }

            // Initialize
            loadFromStorage();
            renderTable();
        </script>
    </body>
</html>
